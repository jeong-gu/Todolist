{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>To Do List 메인</title>
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
</head>
<body>
    <!-- 상단 바 -->
    <div class="top-bar">
        <h2 class="title">To Do List</h2>
        <div class="user-info">
            {{ request.user.username }}님 /
            <a href="{% url 'logout' %}">로그아웃</a>
        </div>
    </div>

    <!-- 보드 컨테이너 -->
    <div class="board-container">

        <!-- To Do 카드 -->
        <div class="board todo">
            <div class="board-header">
                <h3>to do</h3>
                <!-- 오른쪽 상단 ➕ 아이콘 -->
                <button class="add-button" onclick="openModal()">
                    <svg width="24" height="24" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M7.70837 12.4583H9.29171V9.29165H12.4584V7.70831H9.29171V4.54165H7.70837V7.70831H4.54171V9.29165H7.70837V12.4583Z" fill="currentColor"/>
                        <path d="M8.5 16.4166C12.5619 16.4166 16.4167 12.5619 16.4167 8.49998C16.4167 4.43808 12.5619 0.583313 8.5 0.583313C4.4381 0.583313 0.583374 4.43808 0.583374 8.49998C0.583374 12.5619 4.4381 16.4166 8.5 16.4166Z" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    </button>

            </div>
            <ul>
                {% for todo in todos %}
                    <li>
                        <div class="left">
                            <span>{{ todo.content }}</span>
                            <span class="date">{{ todo.completed_at|date:"Y.m.d" }}까지</span>
                        </div>
                        <div class="right">
                            <a href="{% url 'complete_todo' todo.id %}" class="complete-icon">
                            <svg width="20" height="20" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 15.5C6.9625 15.5 5.9875 15.3031 5.075 14.9094C4.1625 14.5156 3.36875 13.9813 2.69375 13.3063C2.01875 12.6313 1.48438 11.8375 1.09063 10.925C0.696875 10.0125 0.5 9.0375 0.5 8C0.5 6.9625 0.696875 5.9875 1.09063 5.075C1.48438 4.1625 2.01875 3.36875 2.69375 2.69375C3.36875 2.01875 4.1625 1.48438 5.075 1.09063C5.9875 0.696875 6.9625 0.5 8 0.5C9.0375 0.5 10.0125 0.696875 10.925 1.09063C11.8375 1.48438 12.6313 2.01875 13.3063 2.69375C13.9813 3.36875 14.5156 4.1625 14.9094 5.075C15.3031 5.9875 15.5 6.9625 15.5 8C15.5 9.0375 15.3031 10.0125 14.9094 10.925C14.5156 11.8375 13.9813 12.6313 13.3063 13.3063C12.6313 13.9813 11.8375 14.5156 10.925 14.9094C10.0125 15.3031 9.0375 15.5 8 15.5ZM8 14C9.675 14 11.0938 13.4187 12.2563 12.2563C13.4187 11.0938 14 9.675 14 8C14 6.325 13.4187 4.90625 12.2563 3.74375C11.0938 2.58125 9.675 2 8 2C6.325 2 4.90625 2.58125 3.74375 3.74375C2.58125 4.90625 2 6.325 2 8C2 9.675 2.58125 11.0938 3.74375 12.2563C4.90625 13.4187 6.325 14 8 14Z" fill="#3C70A9"/>
                            </svg>
                        </a>
                        </div>
                    </li>
                {% empty %}
                    <li>할 일이 없습니다.</li>
                {% endfor %}
            </ul>
        </div>

        <!-- End To Do 카드 -->
        <div class="board end-todo">
            <div class="board-header">
            <h3>end to do</h3>
            </div>
            <ul>
                {% for todo in completed_todos %}
                    <li>
                        <span>{{ todo.content }}</span>
                        <a>✅</a>
                    </li>
                {% empty %}
                    <li>완료한 할 일이 없습니다.</li>
                {% endfor %}
            </ul>
        </div>

        <!-- Not End To Do 카드   -->
        <div class="board not-end-todo">
            <div class="board-header">
            <h3>not end to do</h3>
            </div>
            <ul>
                {% for todo in overdue_todos %}
                    <li>
                        <span>{{ todo.content }}</span>
                        <a href="{% url 'complete_todo' todo.id %}" class="complete-icon">
                            <svg width="20" height="20" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 15.5C6.9625 15.5 5.9875 15.3031 5.075 14.9094C4.1625 14.5156 3.36875 13.9813 2.69375 13.3063C2.01875 12.6313 1.48438 11.8375 1.09063 10.925C0.696875 10.0125 0.5 9.0375 0.5 8C0.5 6.9625 0.696875 5.9875 1.09063 5.075C1.48438 4.1625 2.01875 3.36875 2.69375 2.69375C3.36875 2.01875 4.1625 1.48438 5.075 1.09063C5.9875 0.696875 6.9625 0.5 8 0.5C9.0375 0.5 10.0125 0.696875 10.925 1.09063C11.8375 1.48438 12.6313 2.01875 13.3063 2.69375C13.9813 3.36875 14.5156 4.1625 14.9094 5.075C15.3031 5.9875 15.5 6.9625 15.5 8C15.5 9.0375 15.3031 10.0125 14.9094 10.925C14.5156 11.8375 13.9813 12.6313 13.3063 13.3063C12.6313 13.9813 11.8375 14.5156 10.925 14.9094C10.0125 15.3031 9.0375 15.5 8 15.5ZM8 14C9.675 14 11.0938 13.4187 12.2563 12.2563C13.4187 11.0938 14 9.675 14 8C14 6.325 13.4187 4.90625 12.2563 3.74375C11.0938 2.58125 9.675 2 8 2C6.325 2 4.90625 2.58125 3.74375 3.74375C2.58125 4.90625 2 6.325 2 8C2 9.675 2.58125 11.0938 3.74375 12.2563C4.90625 13.4187 6.325 14 8 14Z" fill="#3C70A9"/>
                            </svg>
                        </a>

                    </li>
                {% empty %}
                    <li>아직 분류되지 않은 항목이 없습니다.</li>
                {% endfor %}
            </ul>
        </div>

    </div>
    <!-- ✅ 모달 배경 -->
    <div id="todoModal" class="modal hidden">
        <div class="modal-content">
        <!-- 닫기 버튼 -->
        <div class="modal-header">
            <span class="close" onclick="closeModal()">×</span>
        </div>
    
        <!-- 폼 -->
        <form action="{% url 'main' %}" method="POST">
            {% csrf_token %}
            
            <!-- 입력 필드 -->
            <h3><span style="color: #2b66e2; font-size: 10px;">●</span> TO DO 입력</h3>
            <input type="text" name="content" placeholder="할 일 내용을 입력하세요" required
                    style="width: 90%; padding: 10px; border-radius: 8px; border: 1px solid #ccc;">

            <h3><span style="color: #2b66e2; font-size: 10px;">●</span> TO DO 기한 설정</h3>
            <input type="text" name="completed_at"
                placeholder=" "
                onfocus="this.type='date'; this.showPicker();" required
                style="width: 90%; padding: 10px; border-radius: 8px; border: 1px solid #ccc;" />

    
            <div style="width: 100%; margin-top: 20px; display: flex; justify-content: flex-end; gap: 12px;">
                <button type="button" onclick="closeModal()" style="background: none; border: none; color: #888; font-size: 13px; cursor: pointer;">
                    취소
                </button>
                <button type="submit" style="background: none; border: none; color: #2b66e2; font-size: 13px; font-weight: bold; cursor: pointer;">
                    저장 후 닫기
                </button>
            </div>
              
        </form>
        </div>
    </div>
  
    
<script src="{% static 'js/scripts.js' %}"></script>
</body>
</html>